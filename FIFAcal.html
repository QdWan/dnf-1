<!DOCTYPE html>
<html>
	<head>
		<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
        <meta charset="utf-8">
		<meta name="viewport" content="width=device-width" />

		<title>이적 시장 수수료 계산기</title>

		<style type="text/css">
			* {
				padding:0px;
				margin:0px;
				border:0px;

				font-family:Arial;
				font-size:22px;
				line-height:30px;
				text-decoration:none;
			}

			.center {
				text-align:center;
			}
			.orange {
				color:orange;
			}
			.yellow {
				color:yellow;
			}
			.blue {
				color:skyblue;
			}

			html, body {
				position:relative;
				width:100%;
				height:100%;
				background-color:#707070;
			}

			#wrapper {
				position:relative;
				margin:0px auto;
				width:100%;
				min-width:350px;
				max-width:800px;

				box-sizing: border-box;
			}

			.title {
				position:relative;
				padding:3px 0px 3px 10px;
				width:100%;
				height:50px;

				/* Permalink - use to edit and share this gradient: http://colorzilla.com/gradient-editor/#a3a3a3+0,000000+100 */
				background: #a3a3a3; /* Old browsers */
				background: -moz-linear-gradient(top, #a3a3a3 0%, #000000 100%); /* FF3.6-15 */
				background: -webkit-linear-gradient(top, #a3a3a3 0%,#000000 100%); /* Chrome10-25,Safari5.1-6 */
				background: linear-gradient(to bottom, #a3a3a3 0%,#000000 100%); /* W3C, IE10+, FF16+, Chrome26+, Opera12+, Safari7+ */
				border:3px #4E4E4E solid;
				box-sizing: border-box;

				color:white;
				font-size:23px;
				font-weight:bold;
				line-height:38px;
			}
			.wrap {
				position:relative;
				padding:10px 0px 10px 10px;
				width:100%;

				background:#232323;
				border:3px #4E4E4E solid;
				box-sizing: border-box;

				color:white;
				font-weight:bold;
				line-height:150%;
			}
				#wrap_input {
					height:55px;
				}
				#wrap_fee {
					height:55px;
				}
				#wrap_discount {
					height:205px;
				}
				#wrap_output {
					height:90px;
				}
					#wrap_output p:first-child {
						margin-bottom:5px;
					}
			.saleform_text {
				height:30px;
				clear:left;
				float:left;
			}
			input.text {
				display:block;
				float:left;
				padding-right:5px;
				margin-left:5px;
				height:30px;

				background:white;
				border:1px gray solid;
				box-sizing: border-box;

				color:black;
				text-align:right;
			}
				input#text1 {
					float:left;
					width:calc(100% - 204px);
				}
				input#text2 {
					background:#4E4E4E;
					width:calc(100% - 109px);

					color:white;
				}
				input#text3 {
					width:calc(100% - 262px);
					max-width:150px;
				}
				input#text4, input#text5 {
					width:calc(100% - 125px);

					background:#4E4E4E;

					color:white;
				}
				.discount_radio {
					display:block;
					float:left;
					margin-top:5px;
					margin-right:5px;
					width:20px;
					height:20px;
				}
					.discount_radio:hover {
						cursor:pointer;
					}
				.label_discount {
					display:block;
					float:left;
				}
					.label_discount:hover {
						cursor:pointer;
						text-decoration: underline;
					}
				.submit {
					display:block;
					float:left;
					margin-left:5px;
					width:80px;
					height:30px;

					background: #FFFFFF; /* default */
					border:1px #A4A4A4 solid;
					box-sizing: border-box;

					font-weight:bold;
					line-height:30px;
				}
					.submit:active {
						background: #DEDEDE;
					}
				#saw {
					margin-top:10px;
					width:100%;

					color:yellow;
					text-decoration:underline;
					text-align:center;

					display:inline-block;
				}
		</style>
	</head>
	<body>
		<div id="wrapper">

			<div class="title center">
				이적 시장 수수료 계산기
			</div>
			<div id="wrap_input" class="wrap">
				<form id="saleform">
				<p class="saleform_text">판매금액 : <p>
				<input id="text1" class="text" type="text" placeholder="입력 후 Enter"  maxlength="100">
				<input id="saleform_submit" class="submit" type="submit" value="입력">
				</form>
			</div>
			<div id="wrap_fee" class="wrap">
				<p class="saleform_text">수 수 료 : </p><input id="text2" class="text" type="text" placeholder="자동으로 계산됨" readonly>
			</div>
			<div id="wrap_discount" class="wrap">
				<p class="saleform_text">&lt;할인율&gt;</p>
				<br/>
				<form id="discountform" onsubmit="return false;">
				<input id="discount1" class="discount_radio" name="discount" type="radio" value="0"> <label class="label_discount" for="discount1"><span class="blue">0%</span> <span class="yellow">(미적용)</span></label>
				<br/>
				<input id="discount2" class="discount_radio" name="discount" type="radio" value="0.2"> <label class="label_discount" for="discount2"><span class="blue">20%</span> <span class="yellow">(TOP CLASS 할인)</span></label>
				<br/>
				<input id="discount3" class="discount_radio" name="discount" type="radio" value="0.3"> <label class="label_discount" for="discount3"><span class="blue">30%</span> <span class="yellow">(PC방 할인)</span></label>
				<br/>
				<input id="discount4" class="discount_radio" name="discount" type="radio" value="0.5"> <label class="label_discount" for="discount4"><span class="blue">50%</span> <span class="yellow">(PC방 + TOP 할인)</span></label>
				<br/>
				<input id="discount5" class="discount_radio" name="discount" type="radio" value="custom"> <label class="label_discount" for="discount5"><span class="yellow">직접 입력 (%)</span></label>
				<input id="text3" class="text" type="text" value="" placeholder="입력 후 Enter"> <input class="submit" type="submit" value="입력">
				</form>
			</div>
			<div id="wrap_output" class="wrap">
				<p class="saleform_text">할인 금액 : </p><input id="text4" class="text" type="text" placeholder="자동으로 계산됨" readonly>
				<p class="saleform_text">받을 금액 : </p><input id="text5" class="text" type="text" placeholder="자동으로 계산됨" readonly>
			</div>
			<a id="saw" class="center" href="http://fifa3.inven.co.kr/" target="_blank">참고한 사이트 링크</a>

		</div>
	</body>

	<script type="text/javascript" src="./js/placeholders.min.js"></script>
	<script type="text/javascript">
		//=================================================================================================================
		//※ 변수 지정
		//=================================================================================================================
		var i;

		var value = {
			input:0,//입력값
			fee:0,//수수료
			discount:0,//할인금액
			outcome:0//받을금액
		};

		var $discount = document.getElementsByName("discount");

		//=================================================================================================================
		//※ 함수
		//=================================================================================================================
		//숫자인지 판단 (출처 : http://mwultong.blogspot.com/2007/01/isnum-isnumeric-isnumber-javascript.html)
		function isNumber(s) {
			s += ''; // 문자열로 변환
			s = s.replace(/^\s*|\s*$/g, ''); // 좌우 공백 제거
			if (s == '' || isNaN(s)) return false;
			return true;
		}

		//천단위 콤마 표시 (출처 : http://stackoverflow.com/questions/2901102/how-to-print-a-number-with-commas-as-thousands-separators-in-javascript)
		function thousand(num) {
			if (isNaN(num)) {
				return "";
			} else {
				var temp = parseInt(num.toString().replace(/,/g,''));
				return temp.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
			}
		}


		//=================================================================================================================
		//※ 실행
		//=================================================================================================================
		window.onload = function() {

			document.getElementById("text1").onfocus = function() {
				this.value = '';
			}
			document.getElementById("text1").onkeypress = function(event) {
				if (event.keyCode != 13) {
					this.value = this.value.toString().replace(/,/g,'');
				}
			}
			document.getElementById("text1").onkeyup = function() {
				this.value = thousand(this.value);
			}

			document.getElementById("saleform").onsubmit = function() {
				//포커스 해제 (값 초기화 방지)
				document.getElementById("text1").blur();
				value.input = parseInt(document.getElementById("text1").value.replace(/,/g,''));
				//1000 이상 입력시에만
				if (value.input < 1000) {
					alert("1,000 이상의 수치를 입력해주세요.");
					return;
				//수수료 계산
				} else {
					value.fee = Math.floor(value.input * 0.4);
					document.getElementById("text2").value = thousand(-value.fee);
				}
				//할인 수수료
				var cut = "0";
				for (i=0;i<$discount.length;i++) {
					if ($discount[i].checked == true) {
						cut = $discount[i].value;
						if (cut == "custom") {
							if (document.getElementById("text3").value != "") {
								cut = parseInt(document.getElementById("text3").value) * 0.01;
							} else {
								cut = "0";
							}
						}
					}
				}
				value.discount = Math.floor(value.fee * parseFloat(cut))
				value.outcome = value.input - value.fee + value.discount;
				//최종 가격
				if (value.discount > 0) {
					document.getElementById("text4").value = "+" + thousand(value.discount);
				} else {
					document.getElementById("text4").value = thousand(value.discount);
				}
				document.getElementById("text5").value = thousand(value.outcome);
				return false;
			}

			for (i=0;i<$discount.length;i++) (function(i){
				$discount[i].onclick = function() {
					//판매금액이 입력되었으면 실행
					if (value.input != 0) {
						var cut = "0";
						if ($discount[i].value != "custom") {
							cut = $discount[i].value;
						} else {
							if (document.getElementById("text3").value != "") {
								cut = parseInt(document.getElementById("text3").value) * 0.01;
							} else {
								cut = "0";
							}
						}
						value.discount = Math.floor(value.fee * parseFloat(cut))
						value.outcome = value.input - value.fee + value.discount;
						//최종 가격
						if (value.discount > 0) {
							document.getElementById("text4").value = "+" + thousand(value.discount);
						} else {
							document.getElementById("text4").value = thousand(value.discount);
						}
						document.getElementById("text5").value = thousand(value.outcome);
					}
				}
			})(i);


			document.getElementById("discountform").onsubmit = function() {
				//판매금액이 입력되었으면 실행
				if (! isNumber(parseInt(document.getElementById("text3").value))) {
					alert("숫자를 입력해주세요");
					document.getElementById("text3").value = '';
					return false;
				} else if (parseInt(document.getElementById("text3").value > 100)) {
					alert("100 이하의 값을 입력해주세요");
					document.getElementById("text3").value = '';
					return false;
				}
				if (value.input != 0) {
					$discount[$discount.length-1].checked = true;
					var cut = 0;
					cut = parseInt(document.getElementById("text3").value) * 0.01;
					value.discount = Math.floor(value.fee * parseFloat(cut))
					value.outcome = value.input - value.fee + value.discount;
					//최종 가격
					if (value.discount > 0) {
						document.getElementById("text4").value = "+" + thousand(value.discount);
					} else {
						document.getElementById("text4").value = thousand(value.discount);
					}
					document.getElementById("text5").value = thousand(value.outcome);
				}
				return false;
			}

		}
	</script>
	</body>
</body>
